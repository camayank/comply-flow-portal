Excellent. Below is a single, comprehensive, admin-configurable flow that covers your entire stack—from Incorporation to BS/PL—with RBAC-guarded add/edit/delete of services, periodized execution (monthly/quarterly/annual), dependencies, SLAs, notifications (email + WhatsApp), documents, and auditability. It’s built as a no-code service framework so Admin (or Ops with permission) can modify services without dev help.


---

DigiComply – End-to-End Configurable Service Flow (RBAC, Periodized, No-Code)

A) Governance & RBAC (Who can change what)

Roles: Admin, Ops Lead, Ops Exec, Client, Agent.

RBAC Policy (editable by Admin):

Admin: Full CRUD on Services, Workflows, Templates, SLAs, Notifications, Period Rules, Cross-Service Dependencies.

Ops Lead (Granted by Admin): Create/Edit service templates, publish updates, reassign tasks, override SLAs (with reason).

Ops Exec: Execute tasks, raise exceptions, propose template edits (require approval).

Client: View status, upload documents, complete client tasks, download deliverables.

Agent: Leads & high-level status only.

Audit Trail: Every config change stored with who/what/when/why, diff of old vs new, rollback button for Admin.


---

B) No-Code Service Model (Admin/Ops-Lead configurable)

Service Template Schema (conceptual):

{
"serviceKey": "gst_returns",
"name": "GST Returns Filing",
"periodicity": "MONTHLY",
"periodRule": {"dayOfMonth": 11},
"dependencies": ["gst_registration"],
"clientDataFields": [
{"key":"gstin","label":"GSTIN","type":"text","required":true},
{"key":"turnoverBand","label":"Turnover Band","type":"select","options":["<5cr", "5-20cr", ">20cr"]}
],
"requiredDocuments": [
{"doctype":"sales_register_csv","label":"Sales Register (CSV)","clientUploads":true,"versioned":true},
{"doctype":"purchase_register_csv","label":"Purchase Register (CSV)","clientUploads":true,"versioned":true}
],
"workflow": [
{
"stepKey":"data_intake",
"name":"Data Intake",
"clientTasks":[
{"task":"Upload Sales Register","doctype":"sales_register_csv"},
{"task":"Upload Purchase Register","doctype":"purchase_register_csv"}
],
"opsChecklist":[
"Validate CSV columns",
"Run mismatch report (sales vs eWayBill, if available)"
],
"slaDays":2,
"qaRequired":false
},
{
"stepKey":"recon_and_prep",
"name":"Reconciliation & Working",
"opsChecklist":[
"GSTR-2B reconciliation",
"ITC eligibility adjustments",
"Prepare return draft"
],
"slaDays":2,
"qaRequired":true
},
{
"stepKey":"client_review",
"name":"Client Review & Approval",
"clientTasks":[{"task":"Approve Filing Draft in Portal"}],
"slaDays":1,
"qaRequired":false
},
{
"stepKey":"filing",
"name":"Portal Filing",
"opsChecklist":["File GSTR-3B/GSTR-1 as applicable","Upload filing proof"],
"deliverables":[{"doctype":"gst_ack_pdf","label":"Filing Acknowledgment"}],
"slaDays":1,
"qaRequired":false
}
],
"notifications": {
"events": {
"period_spawned":["email","whatsapp"],
"client_task_assigned":["email","whatsapp"],
"step_completed":["email"],
"sla_at_risk":["email","whatsapp"],
"filing_done":["email","whatsapp"]
}
}
}

> Admin/Ops Lead can clone, modify, publish templates; updates apply to all eligible in-flight orders (not past completed steps).




---

C) Master Service Catalog (with period rules & dependencies)

Below are the baseline templates you asked for. Each is admin-editable, periodized, and linked where needed.

1. Incorporation



Type: One-time (project)

Dependencies: None

Milestones: Name approval → MoA/AoA drafts → Filing → Certificate → PAN/TAN

Deliverables: COI, PAN, TAN, MoA/AoA, Master Data PDF

Auto-triggers on Complete: Spawn Post-Incorporation Initial Filings service; pre-seed client entity data.

2. Post-Incorporation Initial Filings



Type: One-time within 30 days of COI

Milestones: Board meeting docs → Bank A/c proof → Statutory registers → Initial returns (as applicable)

Deliverables: Statutory register set, resolutions, acknowledgments

Dependencies: Incorporation (Completed)

3. GST Registration



Type: One-time (project)

Milestones: KYC & docs → Application → Inspection/queries → GSTIN allotment

Deliverables: GST Registration Certificate

Auto-triggers on Complete: Spawn GST Returns (Monthly/Quarterly) as per turnover & scheme.

4. GST Returns Filings



Type: Periodic (Monthly/Quarterly by turnover/composition)

Steps: Data intake → Reconciliation → Client approval → Filing → Ack upload

Period Rules: Monthly (11th/20th/… as per return type); Quarterly (per QRMP)

Dependencies: GST Registration (Completed)

Reminders: T-7/T-3/T-1 days before due date; SLA escalations as configured

5. TDS Calculation & Returns (24Q/26Q/27Q)



Type: Quarterly

Steps: Payroll/vendor data intake → TDS working → Client approval → Challan payment → Return filing → Form 16/16A generation

Dependencies: Accounting data coherence (or dedicated payroll integration)

Reminders: T-10/T-5/T-1 days; monthly challan reminders if applicable

6. Accounting (Books of Account)



Type: Monthly (rolling)

Steps: Bank feeds/import → Sales/Purchase posting → Ledger reconciliations → Provisional P&L/BS release

Deliverables: Monthly P&L, trial balance, reconciliations report

Feeds/Integrations: Optional Tally/Zoho/QuickBooks connectors

7. PF/ESI Registration & Filings



Type: Registration (one-time) + Monthly Filings

Steps (Monthly): Payroll intake → Contribution calc → Client approval → Payment & return filing → Ack

Dependencies: Payroll master availability

8. Quarterly Filings (Other Statutory)



Type: Quarterly

Examples: MSME returns, FLA (if applicable), other sectoral returns

Config: Admin adds jurisdiction/industry-specific templates as needed

9. Annual Filings Management (ROC/Other)



Type: Annual

Steps: Data intake → Financials finalization checkpoint → Return draft → Client approval → Filing → Ack & extracts

Dependencies: Accounting closure (Books ready), Audit completion (if required)

Deliverables: AOC-4, MGT-7/7A, attachments

10. Income-Tax Return (ITR) Filings (Company/LLP/Individual as applicable)



Type: Annual

Steps: Financial data intake → Computation → Client approval → Payment (if due) → ITR filing → Ack

Dependencies: Accounting closure, TDS/TCS reconciliations

Deliverables: ITR-V, computation sheet, schedules

11. BS & PL (Financial Statements)



Type: Annual (with Monthly Provisionals from Accounting)

Steps: Trial balance freeze → Adjustments (depr/ITC/accuals) → Draft FS → QA → Client sign-off

Deliverables: Signed Balance Sheet, P&L, Notes, Schedules (PDF + XLSX pack)

Dependencies: Monthly accounting + Year-end adjustments

> Admin can attach cross-service automation: e.g., “On BS&PL draft approved → unlock Annual Filings” or “On Incorporation → spawn GST Registration & Bank KYC checklist.”




---

D) Period & Rollover Engine (Smooth management for each period)

Spawner: On cycle creation, the system auto-creates Service Orders per entity per active periodic service (monthly/quarterly/annual).

Period Window: Each Service Order stores periodStart, periodEnd, and dueDate.

Carry-Forwards: Unfinished tasks flagged as exceptions; Admin decides carry/close.

Data Reuse: Last period’s client data & mappings prefilled (GL codes, party masters, turnover band, etc.).

Dynamic Periodicity: Admin can switch periodicity on a per-client basis (e.g., Monthly → Quarterly under QRMP) mid-year with preview and impact list.


---

E) SLA & Escalation Model (Email + WhatsApp)

Task-level SLAs set in template; can be adjusted at order level by Ops Lead (with reason).

Pausing Rules: SLAs pause when status is Waiting on Client or Govt Pending.

Notifications (configurable per template):

Client Reminders: T-7/T-3/T-1 before due date; instant on task assignment; rejection reason prompts.

Ops Alerts: T-24/T-4; SLA breach → escalate to Ops Lead & Admin.

Channels: Email + WhatsApp (template catalog), plus in-app.

Escalation Matrix: Level-1 Ops Lead → Level-2 Admin; optional CC to client sponsor.


---

F) Document Lifecycle (Approval loops, versioning)

Intake: Client/ops upload; auto-tag by service + doctype; virus scan; size/type validation.

Approval: Ops review → Approve/Reject with reason; client notified on rejection.

Versioning: Every reupload increments version; version diff stored.

Expiry Management: For licenses/registrations; bulk reminders & renewal auto-spawn.

Deliverables: Mark specific doctypes as deliverable (visible to client) vs internal workpapers (hidden).


---

G) Execution Views (by stakeholder)

Client

Home: Entity switcher; service cards (status chip, % progress, due date).

Service Detail: Milestones, your tasks, doc locker (upload/reupload), message thread, deliverables.

Compliance Radar: Calendar of upcoming obligations (monthly/quarterly/annual).

Reports: Periodic summary PDFs (e.g., “Q2 Compliance Report”), BS/PL downloads.

Ops Exec

My Tasks: List + Kanban (To Do/In Progress/Waiting/QA/Done), SLA timers.

Task Drawer: Checklist, dependencies graph, internal notes/files, client thread link.

Pending on Client: Aggregated blockers to nudge.

Knowledge Links: SOP snippets per step.

Ops Lead

Team View: Capacity heatmap, reassign, bulk nudges, bottlenecks by step/service.

Exceptions: SLA breaches, repeated rework root causes.

Template Proposals: Draft edits to workflows pending Admin approval.

Admin

Workflow Builder: Drag/drop steps, dependencies, client tasks, docs, QA gates; preview & publish; “apply to in-flight” with impact preview.

Service Health: SLA %, backlog aging, top rejection reasons, per-period completion curve.

Period Controls: Spawn/rollback periods, switch periodicity for cohorts, mass reminders.

RBAC & Audit: Grant Ops Lead authoring rights, review change history, rollback versions.


---

H) Cross-Service Dependencies (out-of-the-box)

Incorporation → Post-Incorporation → GST Registration → GST Returns.

Accounting (Monthly) → BS&PL (Annual Draft) → Annual Filings → ITR.

Payroll Master (if present) → PF/ESI Monthly Filings.

TDS Quarterly depends on monthly payroll/vendor data (from Accounting or payroll module).

All are editable in Dependency Graph (no-code UI). Blocks create contextual hints in Client + Ops UIs.


---

I) Exception Handling & Change Management

Exception Flag: Any task or step can be flagged as exception with category (Govt portal down, Client delay, Data mismatch).

Branch Workflows: Admin can maintain short exception sub-flows (e.g., “Respond to GST Query”).

Global Edits: When laws change, Admin updates templates; Apply Wizard shows “N clients, M in-flight orders affected,” with step-level impact.


---

J) Reporting & MIS (built-in)

Ops: SLA compliance, on-time filings %, rework ratio by step, cycle time by service, queue aging.

Client CX: Document rejection reasons, portal adoption (logins vs queries), compliance health trend.

Period Analytics: Completion by day vs due date; which entities habitually late.

Audit Exports: Chronological activity ledger per service; downloadable JSON/CSV/PDF.

Board Pack: Month-end executive PDF: highlights, risks, upcoming heavy periods.


---

K) Acceptance Criteria (per service, per period)

Spawn: Period opens automatically on schedule; all tasks generated with correct due dates.

Intake: Client receives T-7 reminder & can upload documents without support; wrong docs yield structured rejection + reason.

Execution: Dependencies prevent out-of-order errors; SLA counts pause on waiting states.

Approval: QA gates enforced where marked; approver identity captured in audit.

Delivery: Filing ACKs and finalized BS/PL stored as deliverables; client notified.

Closure: Period closes only when mandatory deliverables present; next period prepped; renewal items auto-spawn.

Traceability: Full “who did what when” timeline renders in one click.


---

L) Quick-Start: Seed Templates (ready for your team)

We will seed the catalog with these ready-to-use templates:

incorporation, post_incorporation, gst_registration, gst_returns_monthly, gst_returns_qrmp, tds_quarterly, accounting_monthly, pf_esi_registration, pf_esi_monthly, quarterly_statutory_generic, annual_filings_roc, itr_annual, bs_pl_annual.

Each has:

Pre-filled steps, SLAs, checklists, required docs, client tasks, dependencies, notifications, and deliverables.


---

M) What this gives you (premium-ready, day one)

Admin-driven scale: Add/modify services & periods without code.

End-to-end visibility: Lead → onboarding → filings → BS/PL → annual closure.

Founder-grade UX: Clear status, fewer follow-ups, investor-friendly deliverables.

Ops leverage: Less chaos, fewer misses, measurable performance.

Premium perception: Feels like an always-on compliance department.

Perfect—let’s operationalize this so reminders and status intimations happen automatically, without anyone nudging manually.

Below is a production-ready notification architecture + configs you can drop into your build. It covers: (1) scheduled reminders (GST on 1st & 2nd, TDS, state/“HSY” filing), (2) event-driven updates when ops changes status, (3) dedupe, retries, escalation, quiet hours, and full auditability.


---

1. What we’re building (in plain English)



Calendared nudges (e.g., GST reminders on the 1st & 2nd every month).

Due-date–aware smart reminders (T-7 / T-3 / T-1 before each service’s actual due date).

Event-driven notices when the team updates status in the backend:

“Pending with you” (client tasks/documents)

“Filed successfully” (deliverable posted)

“Missed/At risk” (SLA or due date)

Channel mix: Email + WhatsApp (HSM templates) + In-app.

No-code control: Admin/Ops Lead can add/modify rules; RBAC-guarded.

Idempotent & respectful: deduping, quiet hours, and opt-out per client.


---

2. System building blocks



2.1 Notification Rules Engine (no-code)

Two rule types:

1. Schedule rules (cron-like): “Send GST reminder on 1st & 2nd 09:00 IST monthly.”


2. Event rules: “When service_order.status changes to Completed, send filing confirmation.”



Who can edit: Admin by default; Ops Lead if granted via RBAC.

Preview & simulate: See who will receive what before publishing.

2.2 Schedulers & Triggers

Cron worker (e.g., BullMQ job) for calendar rules.

Domain events fired by backend:

service.created, period.spawned

task.status_changed

service.status_changed

doc.approved / doc.rejected

sla.at_risk / sla.breached

Debounce window (e.g., 10–15 min) to avoid spamming on rapid updates.

2.3 Delivery & Compliance

Email via your SMTP provider.

WhatsApp via WABA (approved HSM templates with variables).

In-app feed + push (optional).

Audit log for every notification (who/what/when/channel/payload/outcome).

Quiet hours (e.g., 22:00–07:00 IST) with next-morning release.

Retries (exponential backoff) + dead-letter queue.

Suppression: if filing already marked Completed, auto-cancel pending reminders.


---

3. Ready-to-use rule templates (drop-in JSON)



> GST monthly reminders (1st & 2nd of each month; India time)



{
"ruleKey": "gst_monthly_reminders_1st_2nd",
"type": "SCHEDULE",
"scope": { "serviceType": "gst_returns", "periodicity": "MONTHLY" },
"schedule": { "cron": "0 9 1,2 * *", "timezone": "Asia/Kolkata" },
"filters": [
{ "field": "serviceOrder.status", "op": "IN", "value": ["Created","In Progress","Waiting on Client"] },
{ "field": "serviceOrder.dueDate", "op": "AFTER_NOW", "value": true }
],
"channels": ["EMAIL","WHATSAPP","INAPP"],
"template": "GST_REMINDER_GENERIC",
"dedupeWindowMins": 120,
"respectQuietHours": true
}

> GST due-date smart nudges (T-7 / T-3 / T-1)



{
"ruleKey": "gst_due_smart_nudges",
"type": "SCHEDULE",
"scope": { "serviceType": "gst_returns" },
"schedule": { "cron": "*/30 * * * *", "timezone": "Asia/Kolkata" },
"logic": {
"relativeDueDays": [-7, -3, -1]
},
"filters": [
{ "field": "serviceOrder.status", "op": "NE", "value": "Completed" }
],
"channels": ["EMAIL","WHATSAPP"],
"template": "GST_DUE_NUDGE",
"dedupeWindowMins": 1440
}

> TDS quarterly reminders (adjust months/dates per statutory calendar)



{
"ruleKey": "tds_quarterly_reminders",
"type": "SCHEDULE",
"scope": { "serviceType": "tds_quarterly" },
"schedule": { "cron": "0 10 1 4,7,10,1 *", "timezone": "Asia/Kolkata" },
"channels": ["EMAIL","WHATSAPP"],
"template": "TDS_QUARTERLY_REMINDER",
"filters": [{ "field": "serviceOrder.status", "op": "NE", "value": "Completed" }],
"dedupeWindowMins": 120
}

> State/“HSY” filing (generic state filing—admin can rename/retarget)



{
"ruleKey": "state_hsy_monthly",
"type": "SCHEDULE",
"scope": { "serviceType": "state_hsy_monthly" },
"schedule": { "cron": "0 9 1 * *", "timezone": "Asia/Kolkata" },
"channels": ["EMAIL","WHATSAPP"],
"template": "STATE_GENERIC_MONTHLY_REMINDER",
"filters": [{ "field": "serviceOrder.status", "op": "NE", "value": "Completed" }]
}

> Event—status changed → client notified (pending → filed)



{
"ruleKey": "service_status_change_notify",
"type": "EVENT",
"on": "service.status_changed",
"when": [
{ "from": ["Created","In Progress","Waiting on Client","QA Review"], "to": ["Completed"] },
{ "from": ["Created","In Progress"], "to": ["Waiting on Client"] }
],
"actions": [
{ "matchTo":"Completed", "channels":["EMAIL","WHATSAPP","INAPP"], "template":"FILING_DONE_CONFIRMATION" },
{ "matchTo":"Waiting on Client", "channels":["EMAIL","WHATSAPP","INAPP"], "template":"CLIENT_PENDENCY_ALERT" }
],
"dedupeWindowMins": 15,
"respectQuietHours": true
}

> Event—document rejected → client must reupload



{
"ruleKey": "doc_rejected_notify",
"type": "EVENT",
"on": "document.rejected",
"channels": ["EMAIL","WHATSAPP","INAPP"],
"template": "DOC_REJECTED_REUPLOAD",
"include": ["document.type","rejection.reason","serviceOrder.periodLabel"]
}


---

4. Message templates (Email + WhatsApp HSM)



> GST_REMINDER_GENERIC (Email subject + body)
Subject: GST Return – Action Needed for {{entityName}} (Period {{periodLabel}})
Body:
Hello {{clientFirstName}},
GST return for {{entityName}} ({{periodLabel}}) is due on {{dueDate}}.
Next step: {{nextClientAction}}
Portal link: {{portalDeepLink}}
Support: {{csEmail}} | {{csPhone}}
— DigiComply



> GST_DUE_NUDGE (WhatsApp HSM)
Template name (WABA): gst_due_nudge_v1
Variables: {{1:entityName}} {{2:periodLabel}} {{3:dueDate}} {{4:portalDeepLink}}
Text:
GST return for {{1}} ({{2}}) is due on {{3}}. Please complete the pending step here: {{4}}



> FILING_DONE_CONFIRMATION (Email/WA)
“Filing completed for {{entityName}} – {{serviceName}} ({{periodLabel}}). Ack no: {{ackNo}}. Download from your portal: {{portalDeepLink}}”



> CLIENT_PENDENCY_ALERT (Email/WA)
“Your action is pending for {{serviceName}} ({{periodLabel}}): {{pendingItem}}. Complete here: {{portalDeepLink}}”



> DOC_REJECTED_REUPLOAD (Email/WA)
“The document {{docType}} was rejected for {{serviceName}} ({{periodLabel}}). Reason: {{reason}}. Re-upload here: {{portalDeepLink}}”




---

5. Who gets what (audience & fallbacks)



Primary recipients: client account owner + authorized contacts (configurable per entity).

Cc: internal service owner (Ops Exec) for pendency/escalation notices.

Escalation: if no client action in X hours/days → escalate to Ops Lead → optional to Admin.

Fallback channel: if WhatsApp fails → send Email; if Email bounces → log incident + in-app banner.


---

6. Guardrails (so this feels premium, not spammy)



Dedupe by serviceOrderId + template within the window (e.g., 2 hours).

Quiet hours with queueing and 08:30–09:30 IST release window.

Suppression if status switched to Completed before send time.

Digest mode (optional): one consoli

