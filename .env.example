# ===================================
# DigiComply Environment Configuration
# ===================================
#
# ðŸš¨ CRITICAL API KEYS REQUIRED:
# ================================
# These keys are ESSENTIAL for basic functionality:
#
# 1. DATABASE_URL          - Required for ALL operations
# 2. SESSION_SECRET        - Required for authentication
# 3. EMAIL_* credentials   - Required for OTP login (users cannot login without this)
# 4. CREDENTIAL_ENCRYPTION_KEY - Required for security (PLAINTEXT storage without this)
#
# ðŸ”¥ FEATURE-SPECIFIC KEYS (Application works without these, but features are broken):
# ================================
# - STRIPE_SECRET_KEY      - Payment processing
# - ANTHROPIC_API_KEY      - AI document generation
# - GCS_PROJECT_ID + credentials - File uploads (production only)
# - TWILIO_* credentials   - SMS notifications (optional)
#
# ðŸ“‹ QUICK SETUP (Development):
# ================================
# 1. cp .env.example .env
# 2. Set DATABASE_URL to your PostgreSQL
# 3. Set SESSION_SECRET (use: openssl rand -base64 32)
# 4. Set CREDENTIAL_ENCRYPTION_KEY (use: openssl rand -base64 32)
# 5. Configure Gmail for EMAIL_* (https://myaccount.google.com/apppasswords)
# 6. npm run dev
#
# ===================================

# Node Environment
NODE_ENV=development # development | production | test

# ===================================
# DATABASE (PostgreSQL) - REQUIRED
# ===================================
DATABASE_URL=postgresql://user:password@localhost:5432/comply_flow
# Alternative: Individual connection params
# PGHOST=localhost
# PGPORT=5432
# PGUSER=comply_user
# PGPASSWORD=your_password
# PGDATABASE=comply_flow

# ===================================
# SECURITY SECRETS - REQUIRED FOR PRODUCTION
# ===================================
# Generate with: openssl rand -base64 32

# Session secret (minimum 32 characters) - REQUIRED
# Used for: Session cookie encryption, authentication
# Missing: Users cannot login/maintain sessions
SESSION_SECRET=your-super-secure-session-secret-min-32-chars-CHANGE-THIS

# Credential encryption key (minimum 32 characters) - REQUIRED for production
# Used for: Encrypting government API credentials, integration secrets
# Missing: Credentials stored in plaintext (SECURITY VULNERABILITY)
CREDENTIAL_ENCRYPTION_KEY=your-encryption-key-minimum-32-characters-CHANGE-THIS

# JWT secret for API tokens (minimum 32 characters, optional)
JWT_SECRET=your-jwt-secret-minimum-32-characters-CHANGE-THIS

# ===================================
# STORAGE CONFIGURATION
# ===================================
# Enforce database storage in production (recommended: leave unset or set to true)
# Setting this to 'false' allows in-memory storage in production (DANGEROUS - data loss will occur)
# STRICT_STORAGE_CHECK=true

# ===================================
# EMAIL SERVICE (Nodemailer) - CRITICAL
# ===================================
# Used for: OTP delivery, password resets, notifications, alerts
# Missing: Users cannot login (no OTP), no email notifications
# Status: NOT CONFIGURED - Application partially broken

# Gmail example (easiest for development):
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password # Generate at: https://myaccount.google.com/apppasswords
EMAIL_FROM="DigiComply <noreply@digicomply.com>"

# SendGrid example:
# EMAIL_HOST=smtp.sendgrid.net
# EMAIL_PORT=587
# EMAIL_USER=apikey
# EMAIL_PASS=YOUR_SENDGRID_API_KEY

# Custom SMTP:
# EMAIL_HOST=smtp.your-provider.com
# EMAIL_PORT=587
# EMAIL_USER=your-username
# EMAIL_PASS=your-password
# EMAIL_SECURE=false # true for 465, false for other ports

# ===================================
# FILE STORAGE
# ===================================

# Local Storage (Development - works out of box)
# No configuration needed for development
LOCAL_STORAGE_PATH=./uploads

# Google Cloud Storage (Production - CRITICAL for file uploads)
# Used for: Document uploads, file storage, media
# Missing: File uploads fail in production
# Get credentials: https://console.cloud.google.com/iam-admin/serviceaccounts
DEFAULT_OBJECT_STORAGE_BUCKET_ID=your-gcs-bucket-name
GCS_BUCKET_NAME=your-gcs-bucket-name
GCS_PROJECT_ID=your-gcs-project-id
GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json
PRIVATE_OBJECT_DIR=/.private
PUBLIC_OBJECT_SEARCH_PATHS=/public

# ===================================
# PAYMENT GATEWAY (Stripe) - CRITICAL
# ===================================
# Used for: Payment processing, subscriptions, invoicing
# Missing: Payment features completely broken
# Get keys: https://dashboard.stripe.com/test/apikeys
STRIPE_SECRET_KEY=sk_test_... # Test key (development)
# STRIPE_SECRET_KEY=sk_live_... # Live key (production - DO NOT commit!)
STRIPE_WEBHOOK_SECRET=whsec_... # For webhook signature verification

# ===================================
# SMS & MESSAGING (Twilio) - OPTIONAL
# ===================================
# Used for: SMS notifications, 2FA, alerts
# Missing: SMS features disabled (application still works)
# Get keys: https://console.twilio.com
TWILIO_ACCOUNT_SID=your-account-sid
TWILIO_AUTH_TOKEN=your-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ===================================
# AI SERVICES (Anthropic Claude) - CRITICAL for AI features
# ===================================
# Used for: AI document generation, smart suggestions, content analysis
# Missing: All AI features broken (document templates, smart forms)
# Get key: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-... # Required for AI document features

# ===================================
# APPLICATION
# ===================================
PORT=5000
APP_URL=http://localhost:5000

# CORS (Production only - comma-separated list)
ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# ===================================
# INTEGRATIONS (Optional)
# ===================================

# Google Sheets API
GOOGLE_SHEETS_CLIENT_EMAIL=your-service-account@project.iam.gserviceaccount.com
GOOGLE_SHEETS_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# ===================================
# REPLIT (Auto-configured on Replit)
# ===================================
REPL_ID=auto-generated
REPL_SLUG=auto-generated
REPLIT_DOMAINS=auto-generated

# ===================================
# QUICK START INSTRUCTIONS
# ===================================
#
# 1. Copy this file to .env:
#    cp .env.example .env
#
# 2. Generate secure secrets (32+ characters):
#    openssl rand -base64 32
#
# 3. Update DATABASE_URL with your PostgreSQL connection
#
# 4. Configure email service (Gmail recommended for testing):
#    - Enable 2FA on Gmail
#    - Generate app password: https://myaccount.google.com/apppasswords
#    - Use app password in EMAIL_PASS
#
# 5. Start development server:
#    npm run dev
#
# ===================================
# PRODUCTION CHECKLIST
# ===================================
#
# âœ… Set NODE_ENV=production
# âœ… Generate strong SESSION_SECRET (32+ chars)
# âœ… Generate strong CREDENTIAL_ENCRYPTION_KEY (32+ chars)
# âœ… Configure production database URL
# âœ… Set up email service (SendGrid recommended)
# âœ… Configure Google Cloud Storage
# âœ… Set STRIPE_SECRET_KEY to live key
# âœ… Set ALLOWED_ORIGINS to production domains
# âœ… Configure SSL/HTTPS
# âœ… Set up monitoring and logging
#
